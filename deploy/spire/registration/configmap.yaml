apiVersion: v1
kind: ConfigMap
metadata:
  name: spire-registration-config
  namespace: spire-registration
  labels:
    app: spire-registration
data:
  trust_domain: "spiffe-helper.local"
  spire_server_address: "spire-server.spire-server.svc.cluster.local:8081"
  # Sample workload registrations
  # Format: spiffe_id|parent_id|selectors (comma-separated)
  # Parent ID format: spiffe://<trust-domain>/spire/agent/k8s_psat/<cluster-name>/*
  # Selectors format: k8s:ns:<namespace> for namespace, k8s:sa:<service-account> for service account
  # Example workloads for spiffe-helper integration tests
  workloads: |
    spiffe://spiffe-helper.local/ns/default/sa/spiffe-helper-test|spiffe://spiffe-helper.local/spire/agent/k8s_psat/spiffe-helper/*|k8s:ns:default,k8s:sa:spiffe-helper-test
    spiffe://spiffe-helper.local/ns/spiffe-helper/sa/test-workload|spiffe://spiffe-helper.local/spire/agent/k8s_psat/spiffe-helper/*|k8s:ns:spiffe-helper,k8s:sa:test-workload
    spiffe://spiffe-helper.local/ns/httpbin/sa/httpbin|spiffe://spiffe-helper.local/spire/agent/k8s_psat/spiffe-helper/*|k8s:ns:httpbin,k8s:sa:httpbin
